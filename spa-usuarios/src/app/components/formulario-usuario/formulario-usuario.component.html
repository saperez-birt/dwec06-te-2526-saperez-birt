<!-- formulario-usuario.component.html -->
<div class="container mt-4">
    <ng-container *ngIf="!cargando; else cargandoTemplate">
        <ng-container *ngIf="!error; else errorTemplate">
            <div class="form-wrapper">
                <h1 class="form-title">
                    {{ isEditMode ? 'Editar' : 'Crear' }} Usuario
                </h1>
                <form [formGroup]="usuarioForm" (ngSubmit)="onSubmit()" class="usuario-form">
                    <div class="form-group">
                        <label class="form-label">Nombre *</label>
                        <input type="text" 
                            class="form-input" 
                            formControlName="nombre"
                            [class.error]="submitted && f['nombre'].errors">
                        <div *ngIf="submitted && f['nombre'].errors" class="error-message">
                        <span *ngIf="f['nombre'].errors['required']">Nombre obligatorio</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Apellido *</label>
                        <input type="text" 
                            class="form-input" 
                            formControlName="apellido"
                            [class.error]="submitted && f['apellido'].errors">
                        <div *ngIf="submitted && f['apellido'].errors" class="error-message">
                            <span *ngIf="f['apellido'].errors['required']">Apellido obligatorio</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email *</label>
                        <input type="email" 
                            class="form-input" 
                            formControlName="email"
                            [class.error]="submitted && f['email'].errors">
                        <div *ngIf="submitted && f['email'].errors" class="error-message">
                            <span *ngIf="f['email'].errors['required']">Email obligatorio</span>
                            <span *ngIf="f['email'].errors['email']">Email inv√°lido</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Avatar URL (opcional)</label>
                        <input type="url" 
                            class="form-input" 
                            formControlName="avatar">
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-submit" [disabled]="usuarioForm.invalid || cargando">
                            {{ isEditMode ? 'Actualizar' : 'Crear' }} Usuario
                        </button>
                        <a routerLink="/usuarios" class="btn-cancelar">
                        Cancelar
                        </a>
                    </div>
                </form>
            </div>
        </ng-container>
    </ng-container>

    <ng-template #cargandoTemplate>
        <div class="loading-container">
        <div class="spinner"></div>
        <span>Cargando formulario...</span>
        </div>
    </ng-template>

    <ng-template #errorTemplate>
        <div class="error-alert">
        {{ error }}
        <button type="button" class="btn-close">&times;</button>
        </div>
    </ng-template>
</div>
